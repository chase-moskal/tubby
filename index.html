<!doctype html>
<html class="tubby">
	<head>
		<meta charset="utf-8"/>
		<meta name="viewport" content="width=device-width, initial-scale=1"/>
		<title>tubby — youtube api helper</title>
		<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Neuton:400,800"/>
		<link rel="stylesheet" href="dist/tubby.css"/>
	</head>
	<body>
		<header class="siteheader">
			<h1>
				<strong>tubby</strong>
				<span>— youtube api helper</span>
			</h1>
			<div>
				<p>sourcecode at <a href="https://github.com/chase-moskal/tubby">github.com/chase-moskal/tubby</a></p>
				<p>by <a href="https://chasemoskal.com">chase moskal</a></p>
			</div>
		</header>
		<main>
			<section>
				<h2>tubby is a work-in-progress javascript module</h2>
				<ul>
					<li>tubby makes it easy to fetch any youtube channel's whole public catalog</li>
					<li>tubby is free and open source</li>
				</ul>
			</section>
			<section class="tubby-videos">
				<h2>demo featuring <a href="https://www.youtube.com/user/JordanPetersonVideos">jordan b peterson's youtube channel</a></h2>
				<ol reversed></ol>
			</section>
		</main>
		<script src="dist/tubby.global.bundle.js"></script>
		<script>
			const apiKey = "AIzaSyCqh3LYa_ikbnZJv0_Iird9Wk6ysK_kZXg" // "Tubby Demo Key"
			const playlistId = "UUL_f53ZEJxp8TtlOkHwMV9Q" // 'uploads' playlist (all videos)
			const videoList = document.querySelector(".tubby-videos ol")

			const clock = Date.now()
			let counter = 0

			// function to render videos to the page
			const onVideosReceived = videos => {
				for (const video of videos) {
					const li = document.createElement("li")
					li.style.backgroundImage = `url("${video.thumbs.small}")`
					li.innerHTML = `
						<a tabindex="0" target="_blank" href="https://www.youtube.com/watch?v=${video.videoId}">
							<p><strong>${video.title}</strong></p>
							<p><small>${
								video.description.length > 200
									? video.description.substring(0, 200) + "..."
									: video.description
							}</small></p>
						</a>
					`
					videoList.appendChild(li)
				}
				counter += videos.length
				console.log(`tubby returned ${counter} videos after ${Date.now() - clock} ms`)
			}

			tubby.getAllVideos({apiKey, playlistId, onVideosReceived})
				.then(videos => console.log(`tubby finished all ${videos.length} videos after ${Date.now() - clock} ms`))

			// // if you only have the channel id, this method is equivalent but slower (one extra round trip)
			// tubby.getAllVideosForChannel({apiKey, channelId, onVideosReceived})

			// // if you can't even find the channel id,
			// //  try this: https://github.com/JohnnyTheTank/youtube-channel-name-converter
		</script>
	</body>
</html>
